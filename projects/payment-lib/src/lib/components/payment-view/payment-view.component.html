<div class="govuk-width-container">

  <div class="govuk-breadcrumbs">
    <ol class="govuk-breadcrumbs__list">
      <li class="govuk-breadcrumbs__list-item">
        <a href="#" (click)="goToCaseTransationPage($event)" class="govuk-back-link">Back</a>
      </li>
    </ol>
  </div>

  <main class="govuk-main-wrapper " id="main-content" role="main">

    <div *ngIf="errorMessage">
      <div class="error-summary" role="group" aria-labelledby="failure-error-summary-heading" tabindex="-1">
        <h2 class="heading-medium error-summary-heading" id="failure-error-summary-heading">
          Payment details could not be retrieved
        </h2>
        <div class="govuk-error-summary__body">
          {{ errorMessage }}
        </div>
      </div>
    </div>

    <div *ngIf="!errorMessage && paymentGroup">

      <div class="govuk-grid-row">
        <div class="column">
          <h1 class="heading-medium">Payment details</h1>
        </div>
      </div>

      <hr class="govuk-section-break govuk-section-break--m govuk-section-break--visible"> 
      <table>
        <tbody>
        <tr class="section">
          <td class="bold" width="330px">Payment reference</td>
          <td>{{ paymentGroup.payments[0].reference }}</td>
        </tr>
        <tr class="section">
          <td class="bold" width="330px">Payment amount</td>
          <td>£{{ paymentGroup.payments[0].amount | number:'.2' }}</td>
        </tr>

        <tr class="section" *ngIf="paymentGroup.payments[0] && paymentGroup.payments[0].document_control_number">
          <td class="bold" width="330px">Payment asset number(DCN)</td>
          <td>{{ paymentGroup.payments[0].document_control_number }}</td>
        </tr>
        <tr class="section" *ngIf="paymentGroup.payments[0] && paymentGroup.payments[0].document_control_number">
          <td class="bold" width="330px">Banked date</td>
          <td>{{ paymentGroup.payments[0].banked_date | date:'dd MMM yyyy' }}</td>
        </tr>
        </tbody>
      </table>

      <div class="govuk-grid-row">
        <div class="column">
          <h2 class="heading-medium">Fee and remission details</h2>
        </div>
      </div>

      <div *ngFor="let fee of paymentGroup.fees">
        <table class="table">
          <tbody>
          <tr class="section">
            <td class="bold" width="330px">Description</td>
            <td>Application for {{ fee.description }}</td>
          </tr>
          <tr class="section">
            <td class="bold" width="330px">Fee code</td>
            <td>{{ fee.code }}</td>
          </tr>
          <tr class="section">
            <td class="bold" width="330px">Fee amount</td>
            <td>£{{ fee.calculated_amount | number:'.2' }}</td>
          </tr>
          <tr *ngIf="fee.net_amount">
            <td class="bold" width="330px">Allocated amount</td>
            <td>£{{ fee.apportion_amount | number:'.2' }}</td>
          </tr>
        </tbody>
      <tbody *ngFor="let remission of paymentGroup.remissions">
          <tr *ngIf="remission.fee_code === fee.code">
            <td class="bold" width="330px">Remission code</td>
            <td>{{remission.hwf_reference}}</td>
          </tr>
          <tr *ngIf="paymentGroup.remissions?.length > 0">
            <td class="bold" width="330px">Remission amount</td>
            <td>£{{ remission.hwf_amount | number:'.2'}}</td>
          </tr>
          </tbody>
        </table>

        <hr class="govuk-section-break govuk-section-break--m govuk-section-break--visible"> 
      </div>

      <!-- card details -->
      <ccpay-card-details *ngIf="isCardPayment && !isTelephonyPayment"></ccpay-card-details>

      <!-- pba details -->
      <ccpay-pba-details *ngIf="!isCardPayment" [payment]="paymentGroup.payments[0]"></ccpay-pba-details>

      <!-- Status histories -->
      <ccpay-payment-statuses *ngIf="isStatusAllocated"></ccpay-payment-statuses>

    </div>

  </main>
</div>
